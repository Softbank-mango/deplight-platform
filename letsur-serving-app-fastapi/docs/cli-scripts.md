# κ°λ° νΈμμ„±μ„ μ„ν• CLI μ¤ν¬λ¦½νΈ κ°€μ΄λ“

μ΄ ν…ν”λ¦Ώμ€ κ°λ° λ° μ΄μ νΈμμ„±μ„ λ•κΈ° μ„ν• λ‡ κ°€μ§€ μ μ©ν• CLI μ¤ν¬λ¦½νΈλ¥Ό `scripts/` λ””λ ‰ν† λ¦¬ λ‚΄μ— ν¬ν•¨ν•κ³  μμµλ‹λ‹¤.

λ¨λ“  μ¤ν¬λ¦½νΈλ” ν”„λ΅μ νΈ λ£¨νΈ λ””λ ‰ν† λ¦¬μ—μ„ `python -m scripts.cli <λ…λ Ήμ–΄>` ν•νƒλ΅ μ‹¤ν–‰ν•  μ μμµλ‹λ‹¤.

---

## 1. ν™κ²½λ³€μ κ΄€λ¦¬

ν™κ²½λ³€μ κ΄€λ¦¬λ¥Ό μ„ν• λ‘ κ°€μ§€ μ£Όμ” μ¤ν¬λ¦½νΈκ°€ μμµλ‹λ‹¤.

### 1.1. `.env` νμΌ μƒμ„± (`render-env-template`)

**(μ£Όμ” μ‚¬μ© κΈ°λ¥)** `.env.tpl` (ν…ν”λ¦Ώ)κ³Ό `.env.values.yaml` (κ°’) νμΌμ„ μ΅°ν•©ν•μ—¬, κ° λ°°ν¬ ν™κ²½μ— λ§λ” μµμΆ… `.env.{stage}` νμΌμ„ μƒμ„±ν•©λ‹λ‹¤.

#### λ©μ 
*   ν™κ²½λ³„ μ„¤μ •μ„ μ²΄κ³„μ μΌλ΅ κ΄€λ¦¬ν•κ³ , λ―Όκ°ν• μ •λ³΄κ°€ Gitμ— μ§μ ‘ λ…Έμ¶λλ” κ²ƒμ„ λ°©μ§€ν•©λ‹λ‹¤.
*   `local`, `dev`, `stg`, `prd` λ“± λ‹¤μ–‘ν• ν™κ²½μ `.env` νμΌμ„ μΌκ΄€λ λ°©μ‹μΌλ΅ μƒμ„±ν•©λ‹λ‹¤.

#### μ‚¬μ©λ²•
1.  **κ°’ μ •μ**: `.env.values.yaml` νμΌμ— κ° ν™κ²½μ—μ„ μ‚¬μ©ν•  μ‹¤μ  κ°’λ“¤μ„ μ •μν•©λ‹λ‹¤.
2.  **λ…λ Ήμ–΄ μ‹¤ν–‰**: μ•„λ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ `.deployment/` λ””λ ‰ν† λ¦¬ μ•„λμ— ν™κ²½λ³„ `.env` νμΌμ„ μƒμ„±ν•©λ‹λ‹¤.

    ```bash
    python -m scripts.cli render-env-template
    ```
    μ΄ λ…λ Ήμ€ `.env.values.yaml`μ— μ •μλ λ¨λ“  ν™κ²½(stage)μ— λ€ν• `.env.apiServer.{stage}` νμΌλ“¤μ„ μƒμ„±ν•©λ‹λ‹¤.

### 1.2. μμ  νμΌ μλ™ μƒμ„± (`generate`)

**(ν…ν”λ¦Ώ κ°λ°μμ© κΈ°λ¥)** `src` λ””λ ‰ν† λ¦¬ λ‚΄μ `BaseSettings` ν΄λμ¤λ¥Ό λ¶„μ„ν•μ—¬, ν™κ²½λ³€μ κ΄€λ ¨ μμ  νμΌλ“¤(`.env.example`, `.env.tpl.example`, `.env.values.yaml.example`)μ„ μλ™μΌλ΅ μƒμ„±ν•κ±°λ‚ μ—…λ°μ΄νΈν•©λ‹λ‹¤.

#### λ©μ 
*   μƒλ΅μ΄ ν™κ²½λ³€μλ¥Ό μ½”λ“(`settings.py`)μ— μ¶”κ°€ν–μ„ λ•, κ΄€λ ¨ μμ  νμΌλ“¤μ„ μλ™μΌλ΅ μ—…λ°μ΄νΈν•λ” λ²κ±°λ΅μ›€μ„ μ¤„μ΄κ³  μ‹¤μλ¥Ό λ°©μ§€ν•©λ‹λ‹¤.

#### μ‚¬μ©λ²•
μ½”λ“μ— μ •μλ `BaseSettings`κ°€ λ³€κ²½λμ—μ„ λ•, μ•„λ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ μμ  νμΌλ“¤μ„ μµμ‹  μƒνƒλ΅ μ—…λ°μ΄νΈν•  μ μμµλ‹λ‹¤.
```bash
python -m scripts.cli generate
```

---

## 2. OpenAPI μ¤ν‚¤λ§ μƒμ„± (`generate-openapi`)

ν„μ¬ FastAPI μ• ν”λ¦¬μΌ€μ΄μ…μ API λ…μ„Έλ¥Ό `openapi.json` νμΌλ΅ μƒμ„±ν•©λ‹λ‹¤.

### λ©μ  λ° μ •μ±…

*   APIμ μ—”λ“ν¬μΈνΈ, μ”μ²­/μ‘λ‹µ ν•μ‹ λ“±μ„ μ •μν•λ” ν‘μ¤€ `openapi.json` μ¤ν‚¤λ§λ¥Ό νμΌλ΅ μ¶”μ¶ν•©λ‹λ‹¤.
*   **μ‚¬λ‚΄ μ •μ±…:** μƒμ„±λ `openapi.json` νμΌμ€ **`ServingEndpoint Spec`μ„ κµ¬μ„±ν•λ” ν•„μ μ”μ†**μ…λ‹λ‹¤. `lamp-cli`λ¥Ό ν†µν•΄ `ServingEndpoint`λ¥Ό μ‚¬λ‚΄ ν”λ«νΌμ— λ“±λ΅ν•  λ•, μ΄ νμΌμ„ λ°λ“μ‹ ν•¨κ» μ—…λ΅λ“ν•΄μ•Ό ν•©λ‹λ‹¤.
*   μƒμ„±λ νμΌμ€ API λ¬Έμ„ μλ™ν™”, λ‹¤λ¥Έ μ„λΉ„μ¤μ™€μ μ—°λ™, API ν΄λΌμ΄μ–ΈνΈ μ½”λ“ μλ™ μƒμ„± λ“± λ‹¤μ–‘ν• μ©λ„λ΅λ„ ν™μ©λ  μ μμµλ‹λ‹¤.

### μ‚¬μ©λ²•

μ•„λ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•λ©΄ ν”„λ΅μ νΈ λ£¨νΈ λ””λ ‰ν† λ¦¬μ— `openapi.json` νμΌμ΄ μƒμ„±λ©λ‹λ‹¤.

```bash
python -m scripts.cli generate-openapi
```

### π’΅ API μ„¤λ… μ»¤μ¤ν„°λ§μ΄μ§• (`description.md`)

ν”„λ΅μ νΈ λ£¨νΈ λ””λ ‰ν† λ¦¬μ— μλ” `description.md` νμΌμ„ μμ •ν•λ©΄, `openapi.json`μ— ν¬ν•¨λλ” APIμ λ©”νƒ€ μ •λ³΄(μ„¤λ…, λ©μ  λ“±)λ¥Ό ν’λ¶€ν•κ² μ±„μΈ μ μμµλ‹λ‹¤.

`generate-openapi` μ¤ν¬λ¦½νΈλ” μ‹¤ν–‰ μ‹ `description.md` νμΌμ λ‚΄μ©μ„ μ½μ–΄ `openapi.json`μ `info.description` ν•„λ“μ— μλ™μΌλ΅ μ‚½μ…ν•΄μ¤λ‹λ‹¤. APIμ λ©μ , μ£Όμ” κΈ°λ¥, μ”μ²­/μ‘λ‹µ μμ‹ λ“±μ„ λ§ν¬λ‹¤μ΄ ν•μ‹μΌλ΅ μμ λ΅­κ² μ‘μ„±ν•λ©΄, λ³„λ„μ μ‘μ—… μ—†μ΄ API λ…μ„Έμ— λ°μν•  μ μμµλ‹λ‹¤.
